% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dataStructure.R
\name{dataStructure}
\alias{dataStructure}
\title{Retrieve the hierarchical structure of a classification scheme}
\usage{
dataStructure(
  endpoint,
  prefix,
  conceptScheme,
  language = "en",
  showQuery = FALSE
)
}
\arguments{
\item{endpoint}{Character string specifying which SPARQL endpoint to query.
Must be one of:
\itemize{
  \item \code{"CELLAR"},
  \item \code{"FAO"}.
}}

\item{prefix}{Character string giving the namespace prefix used for the
selected classification scheme in SPARQL.  
This value must correspond to the \code{Prefix} column returned by
\code{\link{classificationEndpoint}} for the chosen scheme, and it is
used in the query to:
\itemize{
  \item build the \code{PREFIX} declaration (\code{prefixList}),
  \item qualify the scheme and its members
        (e.g. \code{prefix:conceptScheme}, \code{prefix:SomeMember}).
}}

\item{conceptScheme}{The internal identifier of the classification scheme
(also returned by \code{\link{classificationEndpoint}}). It is used in
the SPARQL query together with \code{prefix} to select the target scheme.}

\item{language}{Character string giving the language code for level labels.
Defaults to \code{"en"}.}

\item{showQuery}{Boolean; if \code{TRUE}, the SPARQL query
If \code{FALSE} (default), only the resulting data frame is returned.  
If \code{TRUE}, the function returns a list containing:
\itemize{
  \item \code{SPARQL.query}: the full query text,
  \item \code{dataStructure}: the resulting table.
}}
}
\value{
A data frame containing one row per level of the classification, with
the following columns:
\itemize{
  \item \code{Concept_Scheme} – name of the classification scheme,
  \item \code{Depth} – hierarchical depth of the level,
  \item \code{Level} – label of the level (in the selected language),
  \item \code{Count} – number of categories at this level.
}

If \code{showQuery = TRUE}, a list is returned instead (see details).
}
\description{
This function retrieves structural information about a classification scheme
hosted in the CELLAR or FAO SPARQL repositories.  
It returns one row per hierarchical level and includes metadata such as:
\itemize{
  \item the name of the classification scheme,
  \item the depth of each level,
  \item the label of the level (in a selected language),
  \item the number of categories present at that level.
}
}
\details{
Before executing any SPARQL query, the function performs a pre-check using
\code{\link{classificationEndpoint}} to ensure that the combination
(\code{prefix}, \code{conceptScheme}) exists for the selected endpoint.

If the combination does not exist, or if the endpoint is unavailable,
the function stops with a clear error message *before* issuing any SPARQL request.

The behaviour of this function is also affected by the global option
\code{useLocalDataForVignettes}.  
If set to \code{TRUE}, a local CSV file is returned instead of querying
live endpoints. This is useful for offline use or vignette building.
}
\examples{
\dontrun{
# Minimal example (CELLAR)
dataStructure("CELLAR", prefix = "nace2", conceptScheme = "nace2")

# Loop over all CELLAR schemes
list_data <- classificationEndpoint("CELLAR")
res <- list()
for (i in seq_len(nrow(list_data))) {
  p  <- list_data$Prefix[i]
  cs <- list_data$ConceptScheme[i]
  res[[p]] <- dataStructure("CELLAR", prefix = p, conceptScheme = cs)
}
}

}
\seealso{
\code{\link{classificationEndpoint}},
\code{\link{retrieveClassificationTable}}.
}
